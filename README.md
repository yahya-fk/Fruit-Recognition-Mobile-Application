<div align="center">

	<img src="images/logo.png" alt="ControllApp Logo" width="120" />

	<h1>ControllApp</h1>
	<p><strong>Flutter + Firebase app with on-device TensorFlow Lite image classification</strong></p>

	<p>
		<img src="https://img.shields.io/badge/Flutter-3.x-blue?logo=flutter" alt="Flutter" />
		<img src="https://img.shields.io/badge/Dart-3.5%2B-0175C2?logo=dart" alt="Dart" />
		<img src="https://img.shields.io/badge/Firebase-Auth%20%7C%20Firestore-ffca28?logo=firebase" alt="Firebase" />
		<img src="https://img.shields.io/badge/TensorFlow%20Lite-On--device%20ML-FF6F00?logo=tensorflow" alt="TensorFlow Lite" />
		<img src="https://img.shields.io/badge/Platforms-Android%20%7C%20iOS%20%7C%20Web%20%7C%20Desktop-6aa84f" alt="Platforms" />
	</p>

</div>

ControllApp is a modern Flutter application that combines Firebase authentication and user profiles with on-device machine learning using TensorFlow Lite. Users can register/login, manage their profile (including avatar), and classify fruits either from the gallery or in real time using the device camera.

The app uses a small TFLite model and a friendly UI to demonstrate practical on-device ML in a production-style Flutter app.

---

## Features

- Email/Password authentication (Firebase Auth)
- User profiles saved in Firestore (name + avatar)
- Home dashboard with quick actions
- Image classification from gallery (TFLite)
- Real-time camera classification loop (TFLite + camera)
- Settings page to update profile info and password
- Toast feedback and Material 3 design theme

## Tech Stack

- Flutter (Material 3)
- Dart 3.5+
- Firebase: Auth, Cloud Firestore, Core
- TensorFlow Lite via `tflite_flutter`
- Camera and Image Picker
- Image preprocessing via `image` package

## Project Structure

```
lib/
	main.dart                    # App entry, routes, Firebase init
	firebase_options.dart        # Generated by FlutterFire CLI
	screens/
		home.page.dart             # Welcome + quick actions
		login.page.dart            # Email/password login
		register.page.dart         # Signup + avatar capture
		settings.page.dart         # Profile + password update
		image_classification_screen.dart      # Gallery image classification
		real_time_classification.page.dart    # Live camera classification
	services/
		auth_service.dart          # Auth state helpers
	widgets/
		app_drawer.dart            # Navigation drawer with profile

assets/
	model/
		model.tflite               # TFLite model (32x32 RGB)
		label.txt                  # Labels (info only)
images/                        # App images (logo, avatar, etc.)
```

## Getting Started

### Prerequisites

- Flutter SDK (3.24+ recommended)
- Dart SDK 3.5+
- Android Studio/Xcode with device simulators or a physical device
- A Firebase project with Email/Password Auth enabled

### 1) Clone and install dependencies

```powershell
git clone <your-repo-url>
cd <project-folder>
flutter pub get
```

### 2) Configure Firebase

This project already contains `lib/firebase_options.dart` generated via FlutterFire and `android/app/google-services.json`.

If you need to reconfigure or add other platforms:

1. Create a Firebase project in the Firebase Console
2. Enable Email/Password Authentication
3. Run FlutterFire CLI and select platforms you target

```powershell
dart pub global activate flutterfire_cli
flutterfire configure
```

4. Ensure platform files are in place:
	 - Android: `android/app/google-services.json` (present)
	 - iOS: `ios/Runner/GoogleService-Info.plist`
	 - Web: `web/firebase-messaging-sw.js` if using messaging (optional)

Firestore rules for development (adjust for production):

```js
rules_version = '2';
service cloud.firestore {
	match /databases/{database}/documents {
		match /users/{uid} {
			allow read, write: if request.auth != null && request.auth.uid == uid;
		}
	}
}
```

### 3) Platform permissions

Camera and gallery permissions are required:
- Android: Camera/Storage permissions are requested by the plugins; ensure your `minSdkVersion` meets plugin requirements.
- iOS: Add the following keys to `Info.plist`:

```xml
<key>NSCameraUsageDescription</key>
<string>This app needs camera access for real-time classification.</string>
<key>NSPhotoLibraryUsageDescription</key>
<string>This app needs photo library access to classify gallery images.</string>
```

### 4) Run the app

```powershell
flutter devices
flutter run
```

## Usage

1. Register a new account (email + password) and select a profile picture
2. Login to reach the Home screen
3. Use the drawer or quick actions:
	 - Classifier: pick an image from gallery to classify
	 - Real-time Classifier: live camera classification loop
	 - Settings: update name, avatar, and password

Prediction output shows the top label and confidence score.

## Machine Learning Model

- Format: TensorFlow Lite (`assets/model/model.tflite`)
- Input: 32×32 RGB, normalized to [0, 1]
- Labels: 11 classes (fruit types). A list is embedded in code; `assets/model/label.txt` is provided for reference.

To replace the model:
1. Export a compatible `.tflite` model (same input shape and preprocessing)
2. Replace the file in `assets/model/model.tflite`
3. Update label list in:
	 - `lib/screens/image_classification_screen.dart`
	 - `lib/screens/real_time_classification.page.dart`
4. Run `flutter pub get` then rebuild

## Troubleshooting

- Firebase init errors: ensure `firebase_options.dart` matches your Firebase project and platform config files are present
- Camera not opening: verify device permissions and that no other app is using the camera
- Blank predictions: confirm model input shape (32×32×3) and that images are decoded properly
- Web build: `camera` and some plugins have limited or different support on web; test on Android/iOS for full features

## Scripts and Commands (reference)

```powershell
# Get dependencies
flutter pub get

# Analyze and format
flutter analyze
dart format .

# Run on a specific device
flutter run -d android
flutter run -d ios
```

## Roadmap

- Read labels from `assets/model/label.txt` instead of hard-coding
- Upload profile images to Firebase Storage (instead of base64 in Firestore)
- Add unit/widget tests
- Dark theme and accessibility polish
- CI pipeline for analyze/format/build

## Contributing

Contributions are welcome! Please open an issue to discuss changes. For PRs:
- Keep commits focused and descriptive
- Follow existing code style and lints
- Update docs as needed

## License

This project currently has no license specified. Consider adding one (e.g., MIT) to clarify usage.

